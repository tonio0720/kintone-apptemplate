{"version":3,"sources":["webpack:///webpack/bootstrap 5e76f413b4dea3c35a56","webpack:///./../../common/karin/src/js/api.js","webpack:///./../../common/karin/src/js/Query/index.js","webpack:///./../../common/karin-plugin/src/js/apps.js","webpack:///./../../common/karin/src/js/schema/index.js","webpack:///./src/js/index.js","webpack:///./../../common/karin/src/js/User.js","webpack:///C:/Users/yoshida/Documents/GitHub/karin/frontend/common/karin/src/js/schema/types.json","webpack:///./../../common/karin/src/js/Query/parseQuery.js","webpack:///./../../common/karin-plugin/src/js/autoNumber.js","webpack:///./src/html/link1.html","webpack:///./src/html/link2.html","webpack:///./src/html/link3.html","webpack:///./src/js/color_code.js","webpack:///./src/html/alert.html","webpack:///./src/js/cs_request.js","webpack:///./src/html/checkbox.html"],"names":["api","MAX_API","apiCnt","method","param","options","Error","isGuest","domain","guestSpaceId","basicAuth","userAuth","apiToken","basicAuthBase64","btoa","userAuthBase64","makeRequestURL","hostname","location","urlParts","split","window","kintone","url","setOverrideHeader","xhr","setRequestHeader","setBasicAuthHeader","setUserAuthHeader","setApiTokenAuthHeader","setRequestToken","getRequestToken","setHeaders","indexOf","isUserAuth","isApiTokenAuth","send","resolve","reject","onload","r","status","JSON","parse","responseText","stringify","getFile","responseType","response","statusText","postFile","formData","FormData","append","blob","fileName","Promise","XMLHttpRequest","open","isNeededCSRFToken","downloadFile","fileKey","uploadFile","resetCnt","LOG_OPS","REL_OPS","SORT_TYPES","QueryFn","fnName","args","QueryConst","constName","isNull","n","undefined","isString","isNumber","isArray","Array","isQueryFn","isQueryConst","map","join","Query","logOp","data","params","orders","limit","offset","query","push","type","field","relOp","value","sortType","isNaN","Number","queryCondition","orderStr","length","limitStr","offsetStr","filter","queryString","getApps","appMaster","karin","environments","promise","app","id","fields","token","then","records","APPS","forEach","record","appCode","code","name","rights","viewRecord","includes","addRecord","editRecord","deleteRecord","editApp","clone","convFieldType","fieldType","Object","keys","types","schemaType","findById","obj","getSchema","fieldList","table","subTable","groups","schema","subTables","all","fieldId","label","properties","var","subTableId","subTableCode","childLocalId","vtComponentLocalId","group","FORM_DATA","cybozu","page","layout","rowIndex","row","controlList","colIndex","canvasData","referenceTables","masterApp","filterInputFieldId","filterMasterFieldId","masterFieldIds","size","referenceTable","filterInputField","accessible","masterAppSchema","masterFields","lookups","keyMapping","targetApp","fieldMappings","listFields","targetFieldId","lookup","targetAppSchema","targetField","APP_ID","getId","ENV","CALLING_FROM_SASUKE_ACTION_ID","NEGOTIATION_ACTION_ID","prototype","filterX","callback","array","len","i","result","splice","events","on","event","$","remove","User","isInGroups","IS_MANAGER","DAYS","APP_CALLING_MANAGER","karinui","confirm","isConfirmed","progress","kintoneUtility","rest","getAllRecordsByQuery","leadResp","callingResp","leadRecords","callingRecords","leadRecord","Boolean","sasukeId","customerId","common","callingRecord","sort","a","b","Date","front","cs","updateRecord","sasuke_id","putAllRecords","close","alert","console","log","appendTo","getHeaderMenuSpaceElement","disabled","CUSTOMER_SUPPORT_VIEW","$rows","APP_CUSTOMER_MASTER","APP_NEGOTIATION_MANAGER","$link1","link1Html","$link2","link2Html","$link3","link3Html","fieldId1","fieldId2","fieldId3","link","viewName","attr","recordId","addClass","find","removeClass","empty","getSpaceElement","companyName","customerName","error","getLoginUser","user","codes","users","organizations","organizationTitles","organization","targets","getGroups","some","target","getOrganizations","org","isInOrganizations","groupCode","groupUsers","organizationCode","userTitles","organizationUsers","title","RE_OPTIONS","quoteStorage","replaceQuote","str","current","s","prev","isEsc","endAt","index","startAt","restoreQuote","replace","p1","parenthStorage","replaceParenth","c","restoreParenth","isParenth","test","parseValue","_str","trim","RE_QUERY_FN","match","parseQuery","_queryString","logOps","next","parenth","mainQuery","currentQuery","logOpBefore","logOpAfter","currentOperator","parseOptions","orderBy","appId","errCnt","APP_AUTO_NUMBER","API_TOKEN","app_id","last_num","autoNumber","revision","getAutoNumber","setAutoNumberField","fieldCode","rec","get","set","err","orgs","frontUsers","getFrontUsers","companyIds","APP_COMPANY_MASTER","companyRecords","getCompanyRecords","APP_PROJECT_MANAGEMENT","projectRecords","getProjectRecords","getCustomerIds","customerIds","fn","const","getCallingRecords","negotiationRecords","getNegotiationRecords","prepareRecords","isPriorityCompany","companyId","companyRecord","keyEnterprise","isGenS","projectRecord","isFourMonth","negotiationRecord","each","$row","headerMenu","$alert","alertHtml","text","CHECKBOX_FIELD_ID","CS_ORDER_VIEW_ID","CS_ORDER_POSSIBLE_DATE","TARGET_DATE","viewId","recordIds","getTime","isChecked","prop","for_customer_support","is_cs_request","reload","$check","checkboxHtml","e","$this","hasClass","one","stopPropagation","trigger","closest"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5e76f413b4dea3c35a56","// import Promise from './Promise';\r\n\r\nconst MAX_API = 1000;\r\n\r\nlet apiCnt = 0;\r\n\r\nexport function api(api, method, param, options = {}) {\r\n\r\n    if (apiCnt++ > MAX_API) {\r\n        throw new Error('Exceeded Max Api Request Count');\r\n    }\r\n\r\n    let {\r\n        isGuest,\r\n        domain,\r\n        guestSpaceId,\r\n        basicAuth,\r\n        userAuth,\r\n        apiToken\r\n    } = options;\r\n\r\n    let basicAuthBase64;\r\n    if (basicAuth) {\r\n        basicAuthBase64 = btoa(basicAuth);\r\n    }\r\n\r\n    let userAuthBase64;\r\n    if (userAuth) {\r\n        userAuthBase64 = btoa(userAuth);\r\n    }\r\n\r\n    let makeRequestURL = () => {\r\n\r\n        // method = encodeURIComponent(method);\r\n\r\n        let hostname = (domain) ? domain : location.hostname;\r\n        if (!hostname) {\r\n            return false;\r\n        }\r\n\r\n        if (guestSpaceId) {\r\n            let urlParts = api.split('/');\r\n            return `https://${hostname}/k/guest/${guestSpaceId}/`\r\n                + `${urlParts[2]}/${urlParts[3]}.json?_method=${method}`;\r\n        } else if (!isGuest) {\r\n            return `https://${hostname}${api}.json?_method=${method}`;\r\n        } else if (window && window.kintone && isGuest) {\r\n            return kintone.api.url(api, isGuest);\r\n        }\r\n\r\n    };\r\n\r\n    let setOverrideHeader = (xhr) => {\r\n        xhr.setRequestHeader('X-HTTP-Method-Override', method);\r\n    };\r\n\r\n    let setBasicAuthHeader = (xhr) => {\r\n        if (basicAuthBase64) {\r\n            xhr.setRequestHeader('Authorization', `Basic ${basicAuthBase64}`);\r\n        }\r\n    };\r\n\r\n    let setUserAuthHeader = (xhr) => {\r\n        if (userAuthBase64) {\r\n            xhr.setRequestHeader('X-Cybozu-Authorization', userAuthBase64);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    let setApiTokenAuthHeader = (xhr) => {\r\n        if (apiToken) {\r\n            xhr.setRequestHeader('X-Cybozu-API-Token', apiToken);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    let setRequestToken = () => {\r\n        if (window && window.kintone) {\r\n            param['__REQUEST_TOKEN__'] = kintone.getRequestToken();\r\n        }\r\n    };\r\n\r\n    let setHeaders = (xhr) => {\r\n\r\n        if (!(api.indexOf('file') > -1) || method !== 'POST') {\r\n            xhr.setRequestHeader('Content-Type', 'application/json');\r\n        }\r\n\r\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n        setOverrideHeader(xhr);\r\n        setBasicAuthHeader(xhr);\r\n\r\n        let isUserAuth = setUserAuthHeader(xhr);\r\n        let isApiTokenAuth = setApiTokenAuthHeader(xhr);\r\n\r\n        if (!isUserAuth && !isApiTokenAuth) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n\r\n    };\r\n\r\n    let send = (xhr, resolve, reject) => {\r\n\r\n        xhr.onload = function (r) {\r\n            if (xhr.status === 200) {\r\n                resolve(JSON.parse(xhr.responseText));\r\n            } else {\r\n                reject(JSON.parse(xhr.responseText));\r\n            }\r\n        };\r\n\r\n        xhr.send(JSON.stringify(param));\r\n\r\n    };\r\n\r\n    let getFile = (xhr, resolve, reject) => {\r\n\r\n        xhr.responseType = 'blob';\r\n\r\n        xhr.onload = function (r) {\r\n            if (xhr.status === 200) {\r\n                resolve(xhr.response);\r\n            } else {\r\n                reject(xhr.statusText);\r\n            }\r\n        };\r\n\r\n        xhr.send(JSON.stringify(param));\r\n\r\n    };\r\n\r\n    let postFile = (xhr, resolve, reject) => {\r\n\r\n        let formData = new FormData();\r\n\r\n        if (param['__REQUEST_TOKEN__']) {\r\n            formData.append('__REQUEST_TOKEN__', param['__REQUEST_TOKEN__']);\r\n        }\r\n\r\n        formData.append('file', param.blob, param.fileName);\r\n\r\n        xhr.onload = function (r) {\r\n            if (xhr.status === 200) {\r\n                resolve(JSON.parse(xhr.responseText));\r\n            } else {\r\n                reject(JSON.parse(xhr.responseText));\r\n            }\r\n        };\r\n\r\n        xhr.send(formData);\r\n\r\n    };\r\n\r\n    return new Promise((resolve, reject) => {\r\n\r\n        let xhr = new XMLHttpRequest();\r\n        let url = makeRequestURL();\r\n\r\n        if (!url) {\r\n            reject();\r\n        } else {\r\n\r\n            xhr.open('POST', url, true);\r\n\r\n            let isNeededCSRFToken = setHeaders(xhr);\r\n            if (isNeededCSRFToken) {\r\n                setRequestToken();\r\n            }\r\n\r\n            if (!(api.indexOf('file') > -1)) {\r\n                // record\r\n                send(xhr, resolve, reject);\r\n            } else if (method === 'GET') {\r\n                // file\r\n                getFile(xhr, resolve, reject);\r\n            } else {\r\n                postFile(xhr, resolve, reject);\r\n            }\r\n\r\n        }\r\n\r\n    });\r\n\r\n}\r\n\r\nexport const downloadFile = api.downloadFile = ({ fileKey }, options) => {\r\n    return api('/k/v1/file', 'GET', { fileKey }, options);\r\n};\r\n\r\nexport const uploadFile = api.uploadFile = ({ fileName, blob }, options) => {\r\n    return api('/k/v1/file', 'POST', { fileName, blob }, options);\r\n};\r\n\r\nexport const resetCnt = api.resetCnt = () => {\r\n    apiCnt = 0;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin/src/js/api.js","import { parse } from './parseQuery';\r\n\r\n// logical operators\r\nexport const LOG_OPS = [\r\n    'and',\r\n    'or'\r\n];\r\n\r\n// relational operators\r\nexport const REL_OPS = [\r\n    '=',\r\n    '!=',\r\n    '>',\r\n    '<',\r\n    '>=',\r\n    '<=',\r\n    'in',\r\n    'not in',\r\n    'like',\r\n    'not like'\r\n];\r\n\r\nexport const SORT_TYPES = [\r\n    'asc',\r\n    'desc'\r\n];\r\n\r\nexport class QueryFn {\r\n\r\n    constructor(fnName, ...args) {\r\n        this.fnName = fnName;\r\n        this.args = args;\r\n    }\r\n\r\n}\r\n\r\nexport class QueryConst {\r\n\r\n    constructor(constName) {\r\n        this.constName = constName;\r\n    }\r\n\r\n}\r\n\r\nfunction isNull(n) {\r\n    return n === null || n === undefined;\r\n}\r\n\r\nfunction isString(n) {\r\n    return typeof n === 'string';\r\n}\r\n\r\nfunction isNumber(n) {\r\n    return typeof n === 'number';\r\n}\r\n\r\nfunction isArray(n) {\r\n    return Array.isArray(n);\r\n}\r\n\r\n// function isObject(n) {\r\n//     return typeof n === 'object';\r\n// }\r\n\r\nfunction isQueryFn(n) {\r\n    return n instanceof QueryFn;\r\n}\r\n\r\nfunction isQueryConst(n) {\r\n    return n instanceof QueryConst;\r\n}\r\n\r\nfunction stringify(n) {\r\n\r\n    if (isNull(n)) {\r\n        return '\"\"';\r\n    } else if (isArray(n)) {\r\n        return `(${n.map((n) => stringify(n)).join(', ')})`;\r\n    } else if (isString(n)) {\r\n        return `\"${n}\"`;\r\n    } else if (isNumber(n)) {\r\n        return `${n}`;\r\n    } else if (isQueryConst(n)) {\r\n        return n.constName;\r\n    } else if (isQueryFn(n)) {\r\n        return `${n.fnName}${stringify(n.args)}`;\r\n    }\r\n\r\n    return '\"\"';\r\n\r\n}\r\n\r\nexport class Query {\r\n\r\n    constructor(logOp = 'and') {\r\n\r\n        if (LOG_OPS.indexOf(logOp) === -1) {\r\n            throw new Error(`${logOp} is invalid logical operator`);\r\n        }\r\n\r\n        this.data = {\r\n            logOp,\r\n            params: [],\r\n            orders: [],\r\n            limit: null,\r\n            offset: null\r\n        };\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    join(query) {\r\n        this.data.params.push({ type: 'query', query });\r\n        return this;\r\n    }\r\n\r\n    param(field, relOp, value) {\r\n\r\n        if (REL_OPS.indexOf(relOp) === -1) {\r\n            throw new Error(`${relOp} is invalid relational operator`);\r\n        }\r\n\r\n        this.data.params.push({ type: 'param', field, relOp, value });\r\n        return this;\r\n    }\r\n\r\n    orderBy(field, sortType = 'asc') {\r\n\r\n        if (SORT_TYPES.indexOf(sortType) === -1) {\r\n            throw new Error(`${sortType} is invalid sort type`);\r\n        }\r\n\r\n        this.data.orders.push({ field, sortType });\r\n        return this;\r\n    }\r\n\r\n    limit(limit) {\r\n\r\n        if (!isNull(limit) && isNaN(Number(limit))) {\r\n            throw new Error('limit must be a number');\r\n        }\r\n\r\n        this.data.limit = isNull(limit) ? null : Number(limit);\r\n        return this;\r\n\r\n    }\r\n\r\n    offset(offset) {\r\n\r\n        if (!isNull(offset) && isNaN(Number(offset))) {\r\n            throw new Error('offset must be a number');\r\n        }\r\n\r\n        this.data.offset = isNull(offset) ? null : Number(offset);\r\n        return this;\r\n\r\n    }\r\n\r\n    queryCondition() {\r\n\r\n        let { logOp, params } = this.data;\r\n\r\n        return params.map(({ type, query, field, relOp, value }) => {\r\n            switch (type) {\r\n                case 'query':\r\n                    return `(${query.queryCondition()})`;\r\n                case 'param':\r\n                    return `${field} ${relOp} ${stringify(value)}`;\r\n            }\r\n        }).join(` ${logOp} `);\r\n\r\n    }\r\n\r\n    query() {\r\n\r\n        let queryCondition = this.queryCondition();\r\n\r\n        let { orders, limit, offset } = this.data;\r\n\r\n        let orderStr = orders.length === 0 ? ''\r\n            : 'order by ' + orders.map(({ field, sortType }) => `${field} ${sortType}`).join(', ');\r\n        let limitStr = isNull(limit) ? '' : `limit ${limit}`;\r\n        let offsetStr = isNull(offset) ? '' : `offset ${offset}`;\r\n\r\n        return [queryCondition, orderStr, limitStr, offsetStr].filter((n) => n).join(' ');\r\n\r\n    }\r\n\r\n    static fn(fnName, ...args) {\r\n        return new QueryFn(fnName, ...args);\r\n    }\r\n\r\n    static const(constName) {\r\n        return new QueryConst(constName);\r\n    }\r\n\r\n    static parse(queryString) {\r\n        return parse(queryString);\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin/src/js/Query/index.js","import { api } from '../../../karin/src/js/api';\r\n\r\nconst { appMaster } = karin.environments[location.hostname];\r\n\r\nlet promise;\r\n\r\nexport function getApps() {\r\n\r\n    if (promise) {\r\n        return promise;\r\n    }\r\n\r\n    promise = api('/k/v1/records', 'GET', {\r\n        app: appMaster.id,\r\n        query: 'app_code != \"\"',\r\n        limit: 500,\r\n        fields: ['app_code', 'app_id', 'app_name', 'api_token', 'api_token_rights']\r\n    }, { apiToken: appMaster.token.value }).then(({ records }) => {\r\n\r\n        const APPS = {};\r\n\r\n        records.forEach((record) => {\r\n\r\n            let appCode = record['app_code'].value;\r\n\r\n            if (!appCode) {\r\n                return;\r\n            }\r\n\r\n            APPS[appCode] = {\r\n                id: record['app_id'].value,\r\n                code: record['app_code'].value,\r\n                name: record['app_name'].value,\r\n                token: {\r\n                    value: record['api_token'].value,\r\n                    rights: {\r\n                        viewRecord: record['api_token_rights'].value.includes('レコード閲覧'),\r\n                        addRecord: record['api_token_rights'].value.includes('レコード追加'),\r\n                        editRecord: record['api_token_rights'].value.includes('レコード編集'),\r\n                        deleteRecord: record['api_token_rights'].value.includes('レコード削除'),\r\n                        editApp: record['api_token_rights'].value.includes('アプリ管理')\r\n                    }\r\n                }\r\n            };\r\n\r\n        });\r\n\r\n        return APPS;\r\n\r\n    });\r\n\r\n    return promise;\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin-plugin/src/js/apps.js","import types from './types.json';\r\n\r\nfunction clone(n) {\r\n    return JSON.parse(JSON.stringify(n));\r\n}\r\n\r\nfunction convFieldType(fieldType) {\r\n    // return Object.keys(types).find((type) => types[type].schemaType === fieldType);\r\n    return Object.keys(types).filter((type) => types[type].schemaType === fieldType)[0];\r\n}\r\n\r\nfunction findById(obj, id) {\r\n    // let code = Object.keys(obj).find((code) => obj[code].id === id);\r\n    let code = Object.keys(obj).filter((code) => obj[code].id === id)[0];\r\n    return obj[code];\r\n}\r\n\r\nfunction getSchema({ table: { fieldList }, subTable, groups } = {}) {\r\n\r\n    let schema = { fields: {}, subTables: {}, groups: {}, all: {} };\r\n\r\n    if (fieldList) {\r\n\r\n        Object.keys(fieldList).forEach((fieldId) => {\r\n\r\n            let { id, type, label, properties } = fieldList[fieldId];\r\n            let code = fieldList[fieldId].var;\r\n\r\n            if (type === 'GROUP') {\r\n                schema.groups[code] = {\r\n                    id, code, label,\r\n                    fields: []\r\n                };\r\n            } else {\r\n                schema.fields[code] = {\r\n                    id, code, label, properties,\r\n                    type: convFieldType(type),\r\n                    schemaType: type\r\n                };\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    if (subTable) {\r\n\r\n        Object.keys(subTable).forEach((subTableId) => {\r\n\r\n            let { id, label, fieldList } = subTable[subTableId];\r\n            let subTableCode = subTable[subTableId].var, code = subTableCode;\r\n\r\n            schema.subTables[code] = { id, code, label, type: 'SUBTABLE', fields: {} };\r\n\r\n            Object.keys(fieldList).forEach((fieldId) => {\r\n\r\n                let { id, type, label, properties } = fieldList[fieldId];\r\n                let code = fieldList[fieldId].var;\r\n\r\n                schema.subTables[subTableCode].fields[code] = {\r\n                    id, code, label, properties,\r\n                    type: convFieldType(type),\r\n                    schemaType: type,\r\n                    subTable: schema.subTables[subTableCode]\r\n                };\r\n\r\n            });\r\n\r\n        });\r\n\r\n    }\r\n\r\n    if (groups) {\r\n\r\n        groups.forEach(({ childLocalId, vtComponentLocalId }) => {\r\n\r\n            let field = findById(schema.fields, childLocalId);\r\n            let group = findById(schema.groups, vtComponentLocalId);\r\n\r\n            field.group = group;\r\n            group.fields.push(field);\r\n\r\n        });\r\n\r\n    }\r\n\r\n    Object.keys(schema.fields).forEach((code) => {\r\n        let field = schema.fields[code];\r\n        schema.all[field.code] = field;\r\n    });\r\n\r\n    Object.keys(schema.subTables).forEach((subTableCode) => {\r\n\r\n        let subTable = schema.subTables[subTableCode];\r\n        schema.all[subTable.code] = subTable;\r\n\r\n        Object.keys(subTable.fields).forEach((code) => {\r\n            let field = subTable.fields[code];\r\n            schema.all[field.code] = field;\r\n        });\r\n\r\n    });\r\n\r\n    return schema;\r\n\r\n}\r\n\r\nconst FORM_DATA = (cybozu && cybozu.data && cybozu.data.page && cybozu.data.page && cybozu.data.page.FORM_DATA)\r\n    ? clone(cybozu.data.page.FORM_DATA) : {};\r\n\r\n// layout is in json string\r\nFORM_DATA.layout = JSON.parse(FORM_DATA.layout);\r\n\r\nexport const schema = getSchema(FORM_DATA.schema);\r\n\r\nlet rowIndex = 0;\r\n\r\nFORM_DATA.layout.forEach((row) => {\r\n\r\n    if (row.type === 'ROW') {\r\n\r\n        row.controlList.forEach((field, colIndex) => {\r\n\r\n            if (field.type === 'GROUP') {\r\n                field.canvasData.forEach((row) => {\r\n                    row.controlList.forEach((field, colIndex) => {\r\n                        if (field.var) {\r\n                            let code = field.var;\r\n                            schema.fields[code].rowIndex = rowIndex;\r\n                            schema.fields[code].colIndex = colIndex;\r\n                        }\r\n                    });\r\n                    rowIndex++;\r\n                });\r\n            } else {\r\n                if (field.var) {\r\n                    let code = field.var;\r\n                    schema.fields[code].rowIndex = rowIndex;\r\n                    schema.fields[code].colIndex = colIndex;\r\n                }\r\n                rowIndex++;\r\n            }\r\n\r\n        });\r\n\r\n    } else if (row.type === 'SUBTABLE') {\r\n\r\n        let subTableCode = row.var;\r\n        let subTable = schema.subTables[subTableCode];\r\n        subTable.rowIndex = rowIndex;\r\n\r\n        row.controlList.forEach((field, colIndex) => {\r\n            let code = field.var;\r\n            subTable.fields[code].rowIndex = rowIndex;\r\n            subTable.fields[code].colIndex = colIndex;\r\n        });\r\n\r\n        rowIndex++;\r\n\r\n    }\r\n\r\n});\r\n\r\nschema.referenceTables = [];\r\n\r\nFORM_DATA.referenceTables.forEach(({\r\n    id, masterApp, fieldId,\r\n    filterInputFieldId, filterMasterFieldId,\r\n    masterFieldIds, query, size\r\n}) => {\r\n\r\n    let field = findById(schema.all, fieldId);\r\n\r\n    // let referenceTable = {\r\n    //     id, field, masterApp, masterAppSchema,\r\n    //     filterInputField: findById(schema.fields, filterInputFieldId),\r\n    //     filterMasterField: findById(masterAppSchema.fields, filterMasterFieldId),\r\n    //     masterFields: masterFieldIds.map((fieldId) => findById(masterAppSchema.fields, fieldId)),\r\n    //     query: query, size: size\r\n    // };\r\n\r\n    let referenceTable = {\r\n        id, field, masterApp,\r\n        filterInputField: findById(schema.all, filterInputFieldId),\r\n        query: query, size: size\r\n    };\r\n\r\n    if (masterApp.accessible) {\r\n\r\n        let masterAppSchema = getSchema(masterApp.schema);\r\n\r\n        referenceTable.masterAppSchema = masterAppSchema;\r\n        referenceTable.filterMasterFieldId = findById(masterAppSchema.all, filterMasterFieldId);\r\n        referenceTable.masterFields = masterFieldIds.map((fieldId) => findById(masterAppSchema.all, fieldId));\r\n\r\n    } else {\r\n\r\n        referenceTable.masterAppSchema = null;\r\n        referenceTable.filterMasterFieldId = null;\r\n        referenceTable.masterFields = [];\r\n\r\n    }\r\n\r\n    field.referenceTable = referenceTable;\r\n\r\n    schema.referenceTables.push(referenceTable);\r\n\r\n});\r\n\r\nschema.lookups = [];\r\n\r\nFORM_DATA.lookups.forEach(({\r\n    id, keyMapping, targetApp, fieldMappings, listFields, query\r\n}) => {\r\n\r\n    let { fieldId, targetFieldId } = keyMapping;\r\n    let field = findById(schema.all, fieldId);\r\n\r\n    // let lookup = {\r\n    //     id, targetApp, targetAppSchema,\r\n    //     keyMapping: { field, targetField },\r\n    //     fieldMappings: fieldMappings.map(({ fieldId, targetFieldId }) => ({\r\n    //         field: findById(schema.fields, fieldId),\r\n    //         targetField: findById(targetAppSchema.fields, targetFieldId)\r\n    //     })),\r\n    //     listFields: listFields.map((fieldId) => findById(targetAppSchema.fields, fieldId)),\r\n    //     query\r\n    // };\r\n\r\n    let lookup = { id, targetApp, query };\r\n\r\n    if (targetApp.accessible) {\r\n\r\n        let targetAppSchema = getSchema(targetApp.schema);\r\n        let targetField = findById(targetAppSchema.all, targetFieldId);\r\n\r\n        lookup.keyMapping = { field, targetField };\r\n        lookup.targetAppSchema = targetAppSchema;\r\n        lookup.fieldMappings = fieldMappings.map(({ fieldId, targetFieldId }) => ({\r\n            field: findById(schema.all, fieldId),\r\n            targetField: findById(targetAppSchema.all, targetFieldId)\r\n        }));\r\n        lookup.listFields = listFields.map((fieldId) => findById(targetAppSchema.all, fieldId));\r\n\r\n    } else {\r\n\r\n        lookup.keyMapping = { field, targetField: null };\r\n        lookup.targetAppSchema = null;\r\n        lookup.fieldMappings = fieldMappings.map(({ fieldId, targetFieldId }) => ({\r\n            field: findById(schema.all, fieldId),\r\n            targetField: null\r\n        }));\r\n        lookup.listFields = [];\r\n\r\n    }\r\n\r\n    field.lookup = lookup;\r\n\r\n    schema.lookups.push(lookup);\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin/src/js/schema/index.js","import { User } from 'karin/src/js/User';\r\nimport { schema } from 'karin/src/js/schema';\r\nimport { Query } from 'karin/src/js/Query';\r\nimport { setAutoNumberField } from 'karin-plugin/src/js/autoNumber';\r\nimport { getApps } from 'karin-plugin/src/js/apps';\r\n\r\nimport link1Html from '../html/link1.html';\r\nimport link2Html from '../html/link2.html';\r\nimport link3Html from '../html/link3.html';\r\n\r\nimport './color_code';\r\nimport './cs_request';\r\n\r\nconst APP_ID = kintone.app.getId();\r\nconst { CALLING_FROM_SASUKE_ACTION_ID, NEGOTIATION_ACTION_ID } = ENV;\r\n\r\nsetAutoNumberField('sasuke_id');\r\n\r\n/*eslint no-extend-native: \"off\"*/\r\nArray.prototype.filterX = function (callback) {\r\n\r\n    let array = [];\r\n    let len = this.length;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n        let result = callback(this[i], i);\r\n        if (result === true) {\r\n            array.push(this[i]);\r\n            this.splice(i, 1);\r\n            i -= 1;\r\n            len -= 1;\r\n        }\r\n    }\r\n\r\n    return array;\r\n\r\n};\r\n\r\n/*\r\nconst DISABLE_FIELDS = {\r\n    'for_customer_support': ['create', 'edit', 'index.edit'],\r\n    'is_cs_request': ['create', 'edit', 'index.edit']\r\n};\r\n\r\nObject.keys(DISABLE_FIELDS).forEach((fieldCode) => {\r\n\r\n    let modes = DISABLE_FIELDS[fieldCode];\r\n\r\n    modes.forEach((mode) => {\r\n\r\n        let type = `app.record.${mode}.show`;\r\n\r\n        kintone.events.on(type, (event) => {\r\n            event.record[fieldCode].disabled = true;\r\n            return event;\r\n        });\r\n\r\n    });\r\n\r\n});\r\n*/\r\n\r\nkintone.events.on('app.record.index.show', (event) => {\r\n\r\n    $('#bulkCalling').remove();\r\n\r\n    (async function () {\r\n\r\n        const IS_MANAGER = await new User().isInGroups(['GR_MANAGEMENT']);\r\n\r\n        if (!IS_MANAGER) {\r\n            return;\r\n        }\r\n\r\n        $('<button id=\"bulkCalling\" class=\"btn btn-danger\">最新架電取得</button>')\r\n            .on('click', async function () {\r\n\r\n                const DAYS = 31;\r\n\r\n                try {\r\n\r\n                    const { APP_CALLING_MANAGER } = await getApps();\r\n                    const isConfirmed = await karinui.confirm('すべてのレコードの最新架電情報を取得します。\\nよろしいですか？');\r\n\r\n                    if (!isConfirmed) {\r\n                        return;\r\n                    }\r\n\r\n                    karinui.progress.open();\r\n\r\n                    let param = { app: APP_ID, records: [] };\r\n\r\n                    let leadResp = await kintoneUtility.rest.getAllRecordsByQuery({\r\n                        app: APP_ID,\r\n                        query: 'updated_time > FROM_TODAY(-1, MONTHS)'\r\n                    });\r\n\r\n                    let callingResp = await kintoneUtility.rest.getAllRecordsByQuery({\r\n                        app: APP_CALLING_MANAGER.id,\r\n                        query: 'updated_time > FROM_TODAY(-1, MONTHS)'\r\n                    });\r\n\r\n                    let leadRecords = leadResp.records;\r\n                    let callingRecords = callingResp.records;\r\n\r\n                    leadRecords\r\n                        .filter((leadRecord) => Boolean(leadRecord['sasuke_id'].value))\r\n                        .forEach((leadRecord) => {\r\n\r\n                            let sasukeId = leadRecord['sasuke_id'].value;\r\n                            let customerId = leadRecord['customer_id'].value;\r\n\r\n                            let common = callingRecords\r\n                                .filter((callingRecord) => {\r\n\r\n                                    if (callingRecord['sasuke_id'].value) {\r\n                                        return Number(sasukeId) === Number(callingRecord['sasuke_id'].value);\r\n                                    } else if (callingRecord['customer_id'].value) {\r\n                                        return Number(customerId) === Number(callingRecord['customer_id'].value);\r\n                                    }\r\n\r\n                                    return false;\r\n\r\n                                })\r\n                                .sort((a, b) => new Date(b['created_time'].value)\r\n                                    - new Date(a['created_time'].value))[0];\r\n\r\n                            let front = callingRecords\r\n                                .filter((record) => record['type'].value === 'フロント')\r\n                                .filter((callingRecord) => {\r\n\r\n                                    if (callingRecord['sasuke_id'].value) {\r\n                                        return Number(sasukeId) === Number(callingRecord['sasuke_id'].value);\r\n                                    } else if (callingRecord['customer_id'].value) {\r\n                                        return Number(customerId) === Number(callingRecord['customer_id'].value);\r\n                                    }\r\n\r\n                                    return false;\r\n\r\n                                })\r\n                                .sort((a, b) => new Date(b['created_time'].value)\r\n                                    - new Date(a['created_time'].value))[0];\r\n\r\n                            let cs = callingRecords\r\n                                .filter((record) => record['type'].value === 'カスタマーサポート')\r\n                                .filter((callingRecord) => {\r\n\r\n                                    if (callingRecord['sasuke_id'].value) {\r\n                                        return Number(sasukeId) === Number(callingRecord['sasuke_id'].value);\r\n                                    } else if (callingRecord['customer_id'].value) {\r\n                                        return Number(customerId) === Number(callingRecord['customer_id'].value);\r\n                                    }\r\n\r\n                                    return false;\r\n\r\n                                })\r\n                                .sort((a, b) => new Date(b['created_time'].value)\r\n                                    - new Date(a['created_time'].value))[0];\r\n\r\n                            let updateRecord = {\r\n                                id: leadRecord['$id'].value,\r\n                                record: {\r\n                                    sasuke_id: { value: sasukeId }\r\n                                }\r\n                            };\r\n\r\n                            if (common || front || cs) {\r\n\r\n                                if (common) {\r\n                                    updateRecord.record['common_latest_calling_id'] = { value: common['$id'].value };\r\n                                }\r\n\r\n                                if (front) {\r\n                                    updateRecord.record['latest_calling_id'] = { value: front['$id'].value };\r\n                                }\r\n\r\n                                if (cs) {\r\n                                    updateRecord.record['cs_latest_calling_id'] = { value: cs['$id'].value };\r\n                                }\r\n\r\n                                param.records.push(updateRecord);\r\n\r\n                            }\r\n\r\n                        });\r\n\r\n                    await kintoneUtility.rest.putAllRecords(param);\r\n\r\n                    karinui.progress.close();\r\n                    karinui.alert('完了しました。');\r\n\r\n                } catch (e) {\r\n                    console.log(e);\r\n                    karinui.progress.close();\r\n                    karinui.alert('エラーが発生しました。');\r\n                }\r\n\r\n            }).appendTo(kintone.app.getHeaderMenuSpaceElement());\r\n\r\n    })();\r\n\r\n    return event;\r\n\r\n});\r\n\r\nkintone.events.on(['app.record.edit.show'], (event) => {\r\n\r\n    event.record['scan_status'].disabled = true;\r\n\r\n    return event;\r\n\r\n});\r\n\r\nconst CUSTOMER_SUPPORT_VIEW = 'CSテレアポ用';\r\n\r\nkintone.events.on('app.record.index.show', (event) => {\r\n\r\n    if (event.records.length === 0) {\r\n        return event;\r\n    }\r\n\r\n    let $rows = $('.recordlist-row-gaia');\r\n\r\n    (async function () {\r\n\r\n        const { APP_CALLING_MANAGER, APP_CUSTOMER_MASTER, APP_NEGOTIATION_MANAGER } = await getApps();\r\n\r\n        for (let i = 0; i < $rows.length; i++) {\r\n\r\n            let row = $rows[i];\r\n            let record = event.records[i];\r\n\r\n            let $link1 = $(link1Html);\r\n            let $link2 = $(link2Html);\r\n            let $link3 = $(link3Html);\r\n\r\n            let fieldId1 = schema.fields['customer_master'].id;\r\n            let fieldId2 = schema.fields['calling_manager'].id;\r\n            let fieldId3 = schema.fields['negotiation_manager'].id;\r\n\r\n            let link = `/k/${APP_CALLING_MANAGER.id}/edit`\r\n                + `?action=${CALLING_FROM_SASUKE_ACTION_ID}&app=${APP_ID}&record=${record['$id'].value}`;\r\n\r\n            if (event.viewName === CUSTOMER_SUPPORT_VIEW) {\r\n                link += `&calling_type=cs`;\r\n            }\r\n\r\n            $link2.attr('href', link);\r\n\r\n            if (record['customer_record_id'].value) {\r\n\r\n                let recordId = record['customer_record_id'].value;\r\n\r\n                $link1.attr('href', `/k/${APP_CUSTOMER_MASTER.id}/show#record=${recordId}`);\r\n                $link3.attr('href', `/k/${APP_NEGOTIATION_MANAGER.id}/edit`\r\n                    + `?action=${NEGOTIATION_ACTION_ID}&app=${APP_CUSTOMER_MASTER.id}&record=${recordId}`);\r\n\r\n            } else {\r\n                $link1.addClass('disabled');\r\n                $link3.addClass('disabled');\r\n            }\r\n\r\n            $(row).find(`.value-${fieldId1}`)\r\n                .removeClass('recordlist-decimal-gaia')\r\n                .find('>div').empty().append($link1);\r\n\r\n            $(row).find(`.value-${fieldId2}`)\r\n                .removeClass('recordlist-decimal-gaia')\r\n                .find('>div').empty().append($link2);\r\n\r\n            $(row).find(`.value-${fieldId3}`)\r\n                .removeClass('recordlist-decimal-gaia')\r\n                .find('>div').empty().append($link3);\r\n\r\n        }\r\n\r\n    })();\r\n\r\n    return event;\r\n\r\n});\r\n\r\nkintone.events.on(['app.record.detail.show'], (event) => {\r\n\r\n    $('#customer_link').remove();\r\n\r\n    let recordId = event.record['customer_record_id'].value;\r\n\r\n    if (!recordId) {\r\n        return event;\r\n    }\r\n\r\n    (async function () {\r\n\r\n        const { APP_CUSTOMER_MASTER } = await getApps();\r\n\r\n        $('<a id=\"customer_link\" class=\"btn btn-primary\" target=\"_blank\">部署担当者編集画面へ</a>')\r\n            .attr('href', `/k/${APP_CUSTOMER_MASTER.id}/show#record=${recordId}&mode=edit`)\r\n            .appendTo(kintone.app.record.getSpaceElement('space_link'));\r\n\r\n    })();\r\n\r\n    return event;\r\n\r\n});\r\n\r\nkintone.events.on([\r\n    'app.record.create.submit'\r\n], async (event) => {\r\n\r\n    let companyName = event.record['company_name'].value;\r\n    let customerName = event.record['customer_name'].value;\r\n\r\n    let query = new Query()\r\n        .param('company_name', '=', companyName)\r\n        .param('customer_name', '=', customerName);\r\n\r\n    if (event.type === 'app.record.edit.submit') {\r\n        query.param('$id', '!=', event.record['$id'].value);\r\n    }\r\n\r\n    let { records } = await kintone.api('/k/v1/records', 'GET', {\r\n        app: kintone.app.getId(), query: query.query()\r\n    });\r\n\r\n    if (records.length > 0) {\r\n        await karinui.alert('同一会社名、担当者名で登録されているリードがあります。');\r\n        window.open(`/k/${kintone.app.getId()}/show#record=${records[0]['$id'].value}`);\r\n        event.error = 'エラーが発生しました。';\r\n    }\r\n\r\n    return event;\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/index.js","// import { getApps } from './apps';\r\nimport { api } from './api';\r\n\r\nexport class User {\r\n\r\n    constructor(code = kintone.getLoginUser().code) {\r\n        this.code = code;\r\n        // this.userRecord = null;\r\n    }\r\n\r\n    async getUser() {\r\n\r\n        if (!this.user) {\r\n            let { users } = await kintone.api('/v1/users', 'GET', { codes: [this.code] });\r\n            if (users.length > 0) {\r\n                this.user = users[0];\r\n            } else {\r\n                this.user = {};\r\n            }\r\n        }\r\n\r\n        return this.user;\r\n\r\n    }\r\n\r\n    async getGroups() {\r\n\r\n        if (!this.groups) {\r\n            let { groups } = await kintone.api('/v1/user/groups', 'GET', { code: this.code });\r\n            this.groups = groups;\r\n        }\r\n\r\n        return this.groups;\r\n\r\n    }\r\n\r\n    async getOrganizations() {\r\n\r\n        if (!this.organizations) {\r\n            let { organizationTitles } = await kintone.api('/v1/user/organizations', 'GET', { code: this.code });\r\n            this.organizations = organizationTitles.map(({ organization }) => organization);\r\n        }\r\n\r\n        return this.organizations;\r\n\r\n    }\r\n\r\n    async isInGroups([...targets]) {\r\n        let groups = await this.getGroups();\r\n        return targets.some((target) => groups.some((group) => group.code === target));\r\n    }\r\n\r\n    async isInOrganizations([...targets]) {\r\n        let organizations = await this.getOrganizations();\r\n        return targets.some((target) => organizations.some((org) => org.code === target));\r\n    }\r\n\r\n    async isIn([...targets]) {\r\n        return this.isInGroups(targets) || this.isInOrganizations(targets);\r\n    }\r\n\r\n    // async getUserRecord() {\r\n\r\n    //     if (!this.userRecord) {\r\n\r\n    //         const { APP_USER_MASTER } = await getApps();\r\n\r\n    //         let { records } = await api('/k/v1/records', 'GET', {\r\n    //             app: APP_USER_MASTER.id,\r\n    //             query: `user_code = \"${this.code}\"`\r\n    //         }, { apiToken: APP_USER_MASTER.token.value });\r\n\r\n    //         if (records.length > 0) {\r\n    //             this.userRecord = records[0];\r\n    //         }\r\n\r\n    //     }\r\n\r\n    //     return this.userRecord;\r\n\r\n    // }\r\n\r\n    // async field(code) {\r\n\r\n    //     let userRecord = await this.getUserRecord();\r\n\r\n    //     if (!userRecord[code]) {\r\n    //         return null;\r\n    //     }\r\n\r\n    //     return userRecord[code].value;\r\n\r\n    // }\r\n\r\n    isLoginUser() {\r\n        return this.code === kintone.getLoginUser().code;\r\n    }\r\n\r\n    static async getGroupUsers(groupCode) {\r\n\r\n        const { users } = await kintone.api('/v1/group/users', 'GET', { code: groupCode });\r\n\r\n        if (!users) {\r\n            return [];\r\n        }\r\n\r\n        const groupUsers = [];\r\n\r\n        users.forEach((user) => {\r\n            groupUsers.push(new User(user.code));\r\n        });\r\n\r\n        return groupUsers;\r\n\r\n    }\r\n\r\n    static async getOrganizationUsers(organizationCode) {\r\n\r\n        const { userTitles } = await kintone.api('/v1/organization/users', 'GET', { code: organizationCode });\r\n\r\n        if (!userTitles) {\r\n            return [];\r\n        }\r\n\r\n        const organizationUsers = [];\r\n\r\n        userTitles.forEach(({ user, title }) => {\r\n            organizationUsers.push(new User(user.code));\r\n        });\r\n\r\n        return organizationUsers;\r\n\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin/src/js/User.js","module.exports = {\"RECORD_NUMBER\":{\"name\":\"レコード番号\",\"type\":\"RECORD_NUMBER\",\"schemaType\":\"RECORD_ID\",\"isSystemField\":true},\"MODIFIER\":{\"name\":\"更新者\",\"type\":\"MODIFIER\",\"schemaType\":\"MODIFIER\",\"isSystemField\":true},\"CREATOR\":{\"name\":\"作成者\",\"type\":\"CREATOR\",\"schemaType\":\"CREATOR\",\"isSystemField\":true},\"UPDATED_TIME\":{\"name\":\"更新日時\",\"type\":\"UPDATED_TIME\",\"schemaType\":\"MODIFIED_AT\",\"isSystemField\":true},\"CREATED_TIME\":{\"name\":\"作成日時\",\"type\":\"CREATED_TIME\",\"schemaType\":\"CREATED_AT\",\"isSystemField\":true},\"STATUS\":{\"name\":\"ステータス\",\"type\":\"STATUS\",\"schemaType\":\"STATUS\",\"isSystemField\":true},\"STATUS_ASSIGNEE\":{\"name\":\"作業者\",\"type\":\"STATUS_ASSIGNEE\",\"schemaType\":\"STATUS_ASSIGNEE\",\"isSystemField\":true},\"CATEGORY\":{\"name\":\"カテゴリー\",\"type\":\"CATEGORY\",\"schemaType\":\"CATEGORY\",\"isSystemField\":true},\"SINGLE_LINE_TEXT\":{\"name\":\"文字列 (1行)\",\"type\":\"SINGLE_LINE_TEXT\",\"schemaType\":\"SINGLE_LINE_TEXT\",\"isSystemField\":false},\"RICH_TEXT\":{\"name\":\"リッチエディター\",\"type\":\"RICH_TEXT\",\"schemaType\":\"EDITOR\",\"isSystemField\":false},\"MULTI_LINE_TEXT\":{\"name\":\"文字列 (複数行)\",\"type\":\"MULTI_LINE_TEXT\",\"schemaType\":\"MULTIPLE_LINE_TEXT\",\"isSystemField\":false},\"NUMBER\":{\"name\":\"数値\",\"type\":\"NUMBER\",\"schemaType\":\"DECIMAL\",\"isSystemField\":false},\"CALC\":{\"name\":\"計算\",\"type\":\"CALC\",\"schemaType\":\"CALC\",\"isSystemField\":false},\"RADIO_BUTTON\":{\"name\":\"ラジオボタン\",\"type\":\"RADIO_BUTTON\",\"schemaType\":\"SINGLE_CHECK\",\"isSystemField\":false},\"CHECK_BOX\":{\"name\":\"チェックボックス\",\"type\":\"CHECK_BOX\",\"schemaType\":\"MULTIPLE_CHECK\",\"isSystemField\":false},\"MULTI_SELECT\":{\"name\":\"複数選択\",\"type\":\"MULTI_SELECT\",\"schemaType\":\"MULTIPLE_SELECT\",\"isSystemField\":false},\"DROP_DOWN\":{\"name\":\"ドロップダウン\",\"type\":\"DROP_DOWN\",\"schemaType\":\"SINGLE_SELECT\",\"isSystemField\":false},\"DATE\":{\"name\":\"日付\",\"type\":\"DATE\",\"schemaType\":\"DATE\",\"isSystemField\":false},\"TIME\":{\"name\":\"時刻\",\"type\":\"TIME\",\"schemaType\":\"TIME\",\"isSystemField\":false},\"DATETIME\":{\"name\":\"日時\",\"type\":\"DATETIME\",\"schemaType\":\"DATETIME\",\"isSystemField\":false},\"FILE\":{\"name\":\"添付ファイル\",\"type\":\"FILE\",\"schemaType\":\"FILE\",\"isSystemField\":false},\"LINK\":{\"name\":\"リンク\",\"type\":\"LINK\",\"schemaType\":\"LINK\",\"isSystemField\":false},\"USER_SELECT\":{\"name\":\"ユーザー選択\",\"type\":\"USER_SELECT\",\"schemaType\":\"USER_SELECT\",\"isSystemField\":false},\"GROUP_SELECT\":{\"name\":\"グループ選択\",\"type\":\"GROUP_SELECT\",\"schemaType\":\"GROUP_SELECT\",\"isSystemField\":false},\"ORGANIZATION_SELECT\":{\"name\":\"組織選択\",\"type\":\"ORGANIZATION_SELECT\",\"schemaType\":\"ORGANIZATION_SELECT\",\"isSystemField\":false},\"REFERENCE_TABLE\":{\"name\":\"関連レコード一覧\",\"type\":\"REFERENCE_TABLE\",\"schemaType\":\"REFERENCE_TABLE\",\"isSystemField\":false},\"SUBTABLE\":{\"name\":\"テーブル\",\"type\":\"SUBTABLE\",\"schemaType\":\"SUBTABLE\",\"isSystemField\":false},\"GROUP\":{\"name\":\"グループ\",\"type\":\"GROUP\",\"schemaType\":\"GROUP\",\"isSystemField\":false}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/yoshida/Documents/GitHub/karin/frontend/common/karin/src/js/schema/types.json\n// module id = 6\n// module chunks = 0","import { Query, QueryFn, QueryConst, LOG_OPS, REL_OPS, SORT_TYPES } from '.';\r\n\r\nconst RE_OPTIONS = /(order by (.+?)|)\\s*(limit (.+?)|)\\s*(offset (.+?)|)\\s*$/;\r\n\r\nfunction isNull(n) {\r\n    return n === null || n === undefined;\r\n}\r\n\r\nexport function parse(queryString) {\r\n\r\n    const quoteStorage = [];\r\n\r\n    function replaceQuote(str) {\r\n\r\n        let array = str.split(''),\r\n            len = array.length,\r\n            current = null;\r\n\r\n        let result = '';\r\n\r\n        for (let i = 0; i < len; i++) {\r\n\r\n            let s = array[i],\r\n                prev = array[i - 1];\r\n\r\n            let isEsc = prev === '\\\\';\r\n\r\n            if (current) {\r\n                current.str += s;\r\n            }\r\n\r\n            if (!isEsc && s === '\"') {\r\n\r\n                if (current) {\r\n\r\n                    current.endAt = i;\r\n\r\n                    let index = quoteStorage.length;\r\n                    result += `%%quote${index}%%`;\r\n                    quoteStorage[index] = current.str;\r\n\r\n                    current = null;\r\n\r\n                } else {\r\n                    current = { startAt: i, str: s };\r\n                }\r\n\r\n            } else if (!current) {\r\n                result += s;\r\n            }\r\n\r\n        }\r\n\r\n        return result;\r\n\r\n    }\r\n\r\n    function restoreQuote(str) {\r\n        return str.replace(/%%quote(\\d+)%%/g, (str, p1) => quoteStorage[p1]);\r\n    }\r\n\r\n    const parenthStorage = [];\r\n\r\n    function replaceParenth(str) {\r\n\r\n        let array = str.split(''),\r\n            len = array.length,\r\n            current = null;\r\n\r\n        let result = '';\r\n\r\n        for (let i = 0; i < len; i++) {\r\n\r\n            let s = array[i],\r\n                prev = array[i - 1];\r\n\r\n            let isEsc = prev === '\\\\';\r\n\r\n            let c = current;\r\n\r\n            while (c) {\r\n                c.str += s;\r\n                c = c.prev;\r\n            }\r\n\r\n            if (!isEsc && s === '(') {\r\n\r\n                current = { startAt: i, str: s, prev: current };\r\n\r\n            } else if (!isEsc && s === ')') {\r\n\r\n                if (current) {\r\n\r\n                    current.endAt = i;\r\n\r\n                    if (!current.prev) {\r\n                        let index = parenthStorage.length;\r\n                        result += `%%parenth${index}%%`;\r\n                        parenthStorage[index] = current.str;\r\n                    }\r\n\r\n                    current = current.prev;\r\n\r\n                }\r\n\r\n            } else if (!current) {\r\n                result += s;\r\n            }\r\n\r\n        }\r\n\r\n        return result;\r\n\r\n    }\r\n\r\n    function restoreParenth(str) {\r\n        return str.replace(/%%parenth(\\d+)%%/g, (str, p1) => parenthStorage[p1]);\r\n    }\r\n\r\n    function isParenth(str) {\r\n        return /^%%parenth(\\d+)%%$/.test(str);\r\n    }\r\n\r\n    function parseValue(_str) {\r\n\r\n        let str = _str;\r\n        str = str.trim();\r\n\r\n        if (isNull(str)) {\r\n            return '';\r\n        }\r\n\r\n        if (/^\\(.*\\)$/.test(str)) {\r\n\r\n            str = str.replace(/(^\\(|\\)$)/g, '');\r\n            str = replaceQuote(str);\r\n            str = replaceParenth(str);\r\n\r\n            return str.split(',')\r\n                .filter((s) => s)\r\n                .map((s) => s.trim())\r\n                .map((s) => restoreParenth(s))\r\n                .map((s) => restoreQuote(s))\r\n                .map((s) => parseValue(s));\r\n\r\n        }\r\n\r\n        if (/^\".*\"$/.test(str)) {\r\n            return str.replace(/(^\"|\"$)/g, '');\r\n        }\r\n\r\n        if (!isNaN(Number(str))) {\r\n            return Number(str);\r\n        }\r\n\r\n        const RE_QUERY_FN = /^(.+?)(\\(.*\\))$/;\r\n\r\n        if (RE_QUERY_FN.test(str)) {\r\n            let { 1: fnName, 2: args } = str.match(RE_QUERY_FN);\r\n            return new QueryFn(fnName, ...parseValue(args));\r\n        }\r\n\r\n        return new QueryConst(str);\r\n\r\n    }\r\n\r\n    function parseQuery(_queryString) {\r\n\r\n        let queryString = _queryString;\r\n\r\n        queryString = queryString.trim();\r\n        queryString = replaceQuote(queryString);\r\n        queryString = replaceParenth(queryString);\r\n\r\n        queryString = queryString.replace(RE_OPTIONS, '');\r\n        queryString = queryString.trim();\r\n\r\n        let split = queryString.split(' ');\r\n\r\n        let params = [], logOps = [];\r\n        let field = null, relOp = null, value = null;\r\n\r\n        for (let i = 0; i < split.length; i++) {\r\n\r\n            let str = split[i], next = split[i + 1];\r\n\r\n            let parenth = isParenth(str);\r\n\r\n            str = restoreParenth(str);\r\n            str = restoreQuote(str);\r\n\r\n            if (field === null) {\r\n\r\n                if (parenth) {\r\n\r\n                    let queryString = str.replace(/(^\\(|\\)$)/g, '');\r\n                    params.push({ type: 'query', query: parseQuery(queryString) });\r\n\r\n                } else {\r\n                    field = str;\r\n                }\r\n\r\n            } else if (relOp === null) {\r\n\r\n                if (str === 'not') {\r\n                    relOp = [str, next].join(' ');\r\n                    i++;\r\n                } else {\r\n                    relOp = str;\r\n                }\r\n\r\n                if (REL_OPS.indexOf(relOp) === -1) {\r\n                    throw new Error(`${relOp} is invalid relational operator`);\r\n                }\r\n\r\n            } else if (value === null) {\r\n\r\n                value = parseValue(str);\r\n                params.push({ type: 'param', field, relOp, value });\r\n\r\n            } else {\r\n\r\n                let logOp = str;\r\n\r\n                if (LOG_OPS.indexOf(logOp) === -1) {\r\n                    throw new Error(`${logOp} is invalid logical operator`);\r\n                }\r\n\r\n                logOps.push(logOp);\r\n\r\n                field = null;\r\n                relOp = null;\r\n                value = null;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        let logOp = logOps.indexOf('or') > -1 ? 'or' : 'and';\r\n\r\n        let mainQuery = new Query(logOp);\r\n        let currentQuery = null;\r\n\r\n        params.forEach(({ type, query, field, relOp, value }, i) => {\r\n\r\n            let logOpBefore = logOps[i - 1] || logOp,\r\n                logOpAfter = logOps[i] || logOp;\r\n\r\n            let currentOperator = logOpBefore === logOpAfter ? logOpBefore : 'and';\r\n\r\n            if (currentOperator === logOp) {\r\n\r\n                currentQuery = null;\r\n\r\n                switch (type) {\r\n                    case 'param':\r\n                        mainQuery.param(field, relOp, value);\r\n                        break;\r\n                    case 'query':\r\n                        mainQuery.join(query);\r\n                        break;\r\n                }\r\n\r\n            } else {\r\n\r\n                if (!currentQuery) {\r\n                    currentQuery = new Query();\r\n                    mainQuery.join(currentQuery);\r\n                }\r\n\r\n                switch (type) {\r\n                    case 'param':\r\n                        mainQuery.param(field, relOp, value);\r\n                        break;\r\n                    case 'query':\r\n                        mainQuery.join(query);\r\n                        break;\r\n                }\r\n\r\n            }\r\n\r\n        });\r\n\r\n        return mainQuery;\r\n\r\n    }\r\n\r\n    function parseOptions(_queryString) {\r\n\r\n        let queryString = _queryString;\r\n\r\n        queryString = queryString.trim();\r\n\r\n        let match = queryString.match(RE_OPTIONS) || [];\r\n\r\n        let orders = (match[2] || '').split(',')\r\n            .filter((n) => n)\r\n            .map((str) => str.trim().split(' '))\r\n            .map(([field, sortType]) => ({ field, sortType }));\r\n\r\n        let limit = isNull(match[4]) ? null : Number(match[4]);\r\n        let offset = isNull(match[6]) ? null : Number(match[6]);\r\n\r\n        orders.forEach(({ sortType }) => {\r\n            if (SORT_TYPES.indexOf(sortType) === -1) {\r\n                throw new Error(`${sortType} is invalid sort type`);\r\n            }\r\n        });\r\n\r\n        if (!isNull(limit) && isNaN(limit)) {\r\n            throw new Error('limit must be a number');\r\n        }\r\n\r\n        if (!isNull(offset) && isNaN(offset)) {\r\n            throw new Error('offset must be a number');\r\n        }\r\n\r\n        return { orders, limit, offset };\r\n\r\n    }\r\n\r\n    let query = parseQuery(queryString);\r\n    let { orders, limit, offset } = parseOptions(queryString);\r\n\r\n    if (orders.length > 0) {\r\n        orders.forEach(({ field, sortType }) => {\r\n            query.orderBy(field, sortType);\r\n        });\r\n    }\r\n\r\n    if (!isNull(limit)) {\r\n        query.limit(limit);\r\n    }\r\n\r\n    if (!isNull(offset)) {\r\n        query.offset(offset);\r\n    }\r\n\r\n    return query;\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin/src/js/Query/parseQuery.js","import { api } from '../../../karin/src/js/api';\r\nimport { getApps } from './apps';\r\n\r\nexport async function getAutoNumber(appId, errCnt = 0) {\r\n\r\n    if (errCnt > 9) {\r\n        throw new Error('Exceeded Maximum Errors');\r\n    }\r\n\r\n    const { APP_AUTO_NUMBER } = await getApps();\r\n    const API_TOKEN = APP_AUTO_NUMBER.token.value;\r\n\r\n    try {\r\n\r\n        let { records } = await api('/k/v1/records', 'GET', {\r\n            app: APP_AUTO_NUMBER.id,\r\n            query: `app_id = ${appId} limit 1`,\r\n            fields: ['$id', '$revision', 'last_num']\r\n        }, { apiToken: API_TOKEN });\r\n\r\n        if (records.length === 0) {\r\n\r\n            await api('/k/v1/record', 'POST', {\r\n                app: APP_AUTO_NUMBER.id,\r\n                record: {\r\n                    app_id: { value: appId },\r\n                    last_num: { value: 1 }\r\n                }\r\n            }, { apiToken: API_TOKEN });\r\n\r\n            return 1;\r\n\r\n        }\r\n\r\n        let record = records[0];\r\n        let autoNumber = Number(record['last_num'].value) + 1;\r\n\r\n        await api('/k/v1/record', 'PUT', {\r\n            app: APP_AUTO_NUMBER.id,\r\n            id: record['$id'].value,\r\n            revision: record['$revision'].value,\r\n            record: {\r\n                last_num: { value: autoNumber }\r\n            }\r\n        }, { apiToken: API_TOKEN });\r\n\r\n        return autoNumber;\r\n\r\n    } catch (e) {\r\n        return await getAutoNumber(appId, errCnt + 1);\r\n    }\r\n\r\n}\r\n\r\nexport function setAutoNumberField(fieldCode) {\r\n\r\n    kintone.events.on([\r\n        'app.record.create.show',\r\n        'app.record.edit.show',\r\n        'app.record.index.edit.show'\r\n    ], (event) => {\r\n        event.record[fieldCode].disabled = true;\r\n        return event;\r\n    });\r\n\r\n    kintone.events.on(['app.record.create.show'], (event) => {\r\n\r\n        getAutoNumber(kintone.app.getId()).then((autoNumber) => {\r\n            let rec = kintone.app.record.get();\r\n            rec.record[fieldCode].value = autoNumber;\r\n            kintone.app.record.set(rec);\r\n        }, (err) => {\r\n            alert('自動採番の取得に失敗しました。');\r\n        });\r\n\r\n        return event;\r\n\r\n    });\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./../../common/karin-plugin/src/js/autoNumber.js","module.exports = \"<a target=\\\"_blank\\\" class=\\\"link-external\\\">\\r\\n    <i class=\\\"fa fa-user fa-lg\\\"></i>\\r\\n</a>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/html/link1.html\n// module id = 9\n// module chunks = 0","module.exports = \"<a target=\\\"_blank\\\" class=\\\"link-external\\\">\\r\\n    <i class=\\\"fa fa-phone-square fa-lg\\\"></i>\\r\\n</a>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/html/link2.html\n// module id = 10\n// module chunks = 0","module.exports = \"<a target=\\\"_blank\\\" class=\\\"link-external\\\">\\r\\n    <i class=\\\"fa fa-handshake-o fa-lg\\\"></i>\\r\\n</a>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/html/link3.html\n// module id = 11\n// module chunks = 0","import { Query } from 'karin/src/js/Query';\r\nimport { getApps } from 'karin-plugin/src/js/apps';\r\n\r\nimport alertHtml from '../html/alert.html';\r\n\r\nlet companyRecords = [];\r\nlet projectRecords = [];\r\n// let customerRecords = [];\r\nlet callingRecords = [];\r\nlet negotiationRecords = [];\r\nlet frontUsers = [];\r\n\r\nasync function getFrontUsers() {\r\n\r\n    return Promise.all([\r\n        kintone.api('/v1/organization/users', 'GET', { code: 'ORG_MRKT' })\r\n    ]).then((orgs) => {\r\n\r\n        frontUsers = [];\r\n\r\n        orgs.forEach(({ userTitles }) => {\r\n            userTitles.forEach(({ user }) => {\r\n                frontUsers.push(user.code);\r\n            });\r\n        });\r\n\r\n    });\r\n\r\n}\r\n\r\n// 重点企業\r\nasync function getCompanyRecords(companyIds) {\r\n\r\n    const { APP_COMPANY_MASTER } = await getApps();\r\n\r\n    let query = new Query().param('company_id', 'in', companyIds).query();\r\n\r\n    return kintoneUtility.rest.getAllRecordsByQuery({\r\n        app: APP_COMPANY_MASTER.id, query,\r\n        fields: ['company_id', 'key_enterprise']\r\n    }).then(({ records }) => {\r\n        companyRecords = records;\r\n    });\r\n\r\n}\r\n\r\n// 現S\r\nasync function getProjectRecords(companyIds) {\r\n\r\n    const { APP_PROJECT_MANAGEMENT } = await getApps();\r\n\r\n    let query = new Query()\r\n        .param('company_id', 'in', companyIds)\r\n        .param('accuracy', 'in', ['確定'])\r\n        .param('project_class', 'in', ['受注調査'])\r\n        .param('yomi_date', '>', '2015-06-01')\r\n        .param('front', 'not in', ['Administrator'])\r\n        .query();\r\n\r\n    return kintoneUtility.rest.getAllRecordsByQuery({\r\n        app: APP_PROJECT_MANAGEMENT.id, query,\r\n        fields: ['company_id']\r\n    }).then(({ records }) => {\r\n        projectRecords = records;\r\n    });\r\n\r\n}\r\n\r\nasync function getCustomerIds(companyIds) {\r\n\r\n    const { APP_CUSTOMER_MASTER } = await getApps();\r\n\r\n    let query = new Query().param('company_id', 'in', companyIds).query();\r\n\r\n    return kintoneUtility.rest.getAllRecordsByQuery({\r\n        app: APP_CUSTOMER_MASTER.id, query, fields: ['customer_id']\r\n    }).then(({ records }) => {\r\n        return records.map((record) => record['customer_id'].value).filter(n => n);\r\n    });\r\n\r\n}\r\n\r\nasync function getCallingRecords(customerIds) {\r\n\r\n    const { APP_CALLING_MANAGER } = await getApps();\r\n\r\n    let query = new Query()\r\n        .param('customer_id', 'in', customerIds)\r\n        .param('time', '>=', Query.fn('FROM_TODAY', -4, Query.const('MONTHS')))\r\n        .param('result', 'in', ['初回商談_アポ獲得', '1回以上商談_アポ獲得', '現S（納品実績あり）商談_アポ獲得', 'CSテレアポ_アポ獲得'])\r\n        // .param('user', 'in', frontUsers)\r\n        .query();\r\n\r\n    return kintoneUtility.rest.getAllRecordsByQuery({\r\n        app: APP_CALLING_MANAGER.id, query,\r\n        fields: ['company_id', 'customer_id']\r\n    }).then(({ records }) => {\r\n        callingRecords = records;\r\n    });\r\n\r\n}\r\n\r\nasync function getNegotiationRecords(customerIds) {\r\n\r\n    const { APP_NEGOTIATION_MANAGER } = await getApps();\r\n\r\n    let query = new Query()\r\n        .param('customer_id', 'in', customerIds)\r\n        .param('negotiation_date', '>=', Query.fn('FROM_TODAY', -4, Query.const('MONTHS')))\r\n        // .param('front', 'in', frontUsers)\r\n        .query();\r\n\r\n    return kintoneUtility.rest.getAllRecordsByQuery({\r\n        app: APP_NEGOTIATION_MANAGER.id, query,\r\n        fields: ['company_id', 'customer_id']\r\n    }).then(({ records }) => {\r\n        negotiationRecords = records;\r\n    });\r\n\r\n}\r\n\r\nasync function prepareRecords(companyIds) {\r\n\r\n    return Promise.all([\r\n        // getFrontUsers(companyIds),\r\n        getCompanyRecords(companyIds),\r\n        getProjectRecords(companyIds)\r\n    ])\r\n        .then(() => getCustomerIds(companyIds))\r\n        .then((customerIds) => Promise.all([\r\n            getCallingRecords(customerIds),\r\n            getNegotiationRecords(customerIds)\r\n        ]));\r\n\r\n}\r\n\r\nfunction isPriorityCompany(record) {\r\n\r\n    let companyId = Number(record['company_id'].value);\r\n\r\n    if (!companyId) {\r\n        return false;\r\n    }\r\n\r\n    let companyRecord = companyRecords.find((r) => Number(r['company_id'].value) === companyId);\r\n\r\n    if (!companyRecord) {\r\n        return false;\r\n    }\r\n\r\n    let keyEnterprise = companyRecord['key_enterprise'].value;\r\n    return (keyEnterprise.includes('事業会社') || keyEnterprise.includes('パートナー'));\r\n\r\n}\r\n\r\nfunction isGenS(record) {\r\n\r\n    let companyId = Number(record['company_id'].value);\r\n\r\n    if (!companyId) {\r\n        return false;\r\n    }\r\n\r\n    let projectRecord = projectRecords.find((r) => Number(r['company_id'].value) === companyId);\r\n\r\n    if (!projectRecord) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n\r\n}\r\n\r\nfunction isFourMonth(record) {\r\n\r\n    let companyId = Number(record['company_id'].value);\r\n\r\n    if (!companyId) {\r\n        return false;\r\n    }\r\n\r\n    let callingRecord = callingRecords.find((r) => Number(r['company_id'].value) === companyId);\r\n    let negotiationRecord = negotiationRecords.find((r) => Number(r['company_id'].value) === companyId);\r\n\r\n    if (!callingRecord && !negotiationRecord) {\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n\r\n}\r\n\r\nkintone.events.on('app.record.index.show', (event) => {\r\n\r\n    // if (event.viewId === Number(CS_ORDER_VIEW_ID)) {\r\n    //     return event;\r\n    // }\r\n\r\n    if (event.records.length > 0) {\r\n\r\n        let companyIds = event.records\r\n            .map((record) => Number(record['company_id'].value))\r\n            .filter((n) => Boolean(n));\r\n\r\n        prepareRecords(companyIds).then(() => {\r\n\r\n            $('.recordlist-row-gaia').each((index, row) => {\r\n\r\n                let record = event.records[index];\r\n                let $row = $(row);\r\n\r\n                if (isPriorityCompany(record)) {\r\n                    $row.addClass('row-priority-company');\r\n                } else if (isGenS(record)) {\r\n                    $row.addClass('row-gen-s');\r\n                } else if (isFourMonth(record)) {\r\n                    $row.addClass('row-four-month');\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n    }\r\n\r\n    return event;\r\n\r\n});\r\n\r\nkintone.events.on('app.record.detail.show', (event) => {\r\n\r\n    let companyIds = [Number(event.record['company_id'].value)];\r\n\r\n    prepareRecords(companyIds).then(() => {\r\n\r\n        let headerMenu = kintone.app.record.getHeaderMenuSpaceElement();\r\n\r\n        let $alert;\r\n        if (isPriorityCompany(event.record)) {\r\n\r\n            $alert = $(alertHtml).appendTo(headerMenu);\r\n            $alert.addClass('alert-priority-company')\r\n                .find('span').text(' この企業は重点企業です。');\r\n\r\n            $('.gaia-argoui-app-show-toolbar').addClass('toolbar-priority-company');\r\n\r\n        } else if (isGenS(event.record)) {\r\n\r\n            $alert = $(alertHtml).appendTo(headerMenu);\r\n            $alert.addClass('alert-gen-s')\r\n                .find('span').text(' この企業は現Sです。');\r\n\r\n            $('.gaia-argoui-app-show-toolbar').addClass('toolbar-gen-s');\r\n\r\n        } else if (isFourMonth(event.record)) {\r\n\r\n            $alert = $(alertHtml).appendTo(headerMenu);\r\n            $alert.addClass('alert-four-month')\r\n                .find('span').text(' この企業は過去4ヵ月以内にお会いしています。');\r\n\r\n            $('.gaia-argoui-app-show-toolbar').addClass('toolbar-four-month');\r\n\r\n        }\r\n\r\n    });\r\n\r\n    return event;\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/color_code.js","module.exports = \"<div class=\\\"alert\\\">\\r\\n    <i class=\\\"fa fa-exclamation-circle\\\" aria-hidden=\\\"true\\\"></i>\\r\\n    <span></span>\\r\\n</div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/html/alert.html\n// module id = 13\n// module chunks = 0","import { schema } from 'karin/src/js/schema';\r\nimport checkboxHtml from '../html/checkbox.html';\r\n\r\nconst CHECKBOX_FIELD_ID = schema.fields['checkbox'].id;\r\nconst { CS_ORDER_VIEW_ID, CS_ORDER_POSSIBLE_DATE } = ENV;\r\nconst TARGET_DATE = new Date(CS_ORDER_POSSIBLE_DATE);\r\n\r\nkintone.events.on('app.record.index.show', (event) => {\r\n\r\n    $('#csRequest').remove();\r\n\r\n    if (event.viewId !== Number(CS_ORDER_VIEW_ID)) {\r\n        return event;\r\n    }\r\n\r\n    if (event.records.length === 0) {\r\n        return event;\r\n    }\r\n\r\n    $('.recordlist-gaia').addClass('disable-edit').addClass('disable-remove');\r\n\r\n    $(`<button id=\"csRequest\" class=\"btn btn-primary\">キャンディーズに依頼</button>`).on('click', async function () {\r\n\r\n        let recordIds = [];\r\n\r\n        $('.recordlist-row-gaia').each((index, row) => {\r\n\r\n            let record = event.records[index];\r\n\r\n            if ((new Date(record['free_register_time'].value).getTime() - TARGET_DATE.getTime()) < 0) {\r\n                return;\r\n            }\r\n\r\n            let isChecked = $(row).find('.input-checkbox-cybozu').prop('checked');\r\n            if (isChecked) {\r\n                recordIds.push(record['$id'].value);\r\n            }\r\n\r\n        });\r\n\r\n        if (recordIds.length === 0) {\r\n            return;\r\n        }\r\n\r\n        let isConfirmed = await karinui.confirm(`${recordIds.length}件のレコードをキャンディーズに依頼します。\\nよろしいですか？`);\r\n\r\n        if (!isConfirmed) {\r\n            return;\r\n        }\r\n\r\n        karinui.progress.open();\r\n\r\n        try {\r\n\r\n            await kintoneUtility.rest.putAllRecords({\r\n                app: kintone.app.getId(),\r\n                records: recordIds.map((recordId) => ({\r\n                    id: recordId,\r\n                    record: {\r\n                        for_customer_support: { value: ['CS専用'] },\r\n                        is_cs_request: { value: 'キャンディーズ依頼' }\r\n                    }\r\n                }))\r\n            });\r\n\r\n            karinui.progress.close();\r\n\r\n            await karinui.alert('完了しました。');\r\n\r\n            location.reload();\r\n\r\n        } catch (e) {\r\n\r\n            console.log(e);\r\n            karinui.progress.close();\r\n            karinui.alert('エラーが発生しました。');\r\n\r\n        }\r\n\r\n    }).appendTo(kintone.app.getHeaderMenuSpaceElement());\r\n\r\n    $('.recordlist-row-gaia').each((index, row) => {\r\n\r\n        let record = event.records[index];\r\n\r\n        let $check = $(checkboxHtml);\r\n\r\n        $check.on('click', function (e) {\r\n\r\n            let $this = $(this);\r\n\r\n            if ($this.hasClass('disabled')) {\r\n                return;\r\n            }\r\n\r\n            $this.find('input').one('click', (e) => {\r\n                e.stopPropagation();\r\n            }).trigger('click').trigger('focus');\r\n\r\n        });\r\n\r\n        $check.find('input').on('change', function (e) {\r\n\r\n            let $this = $(this);\r\n            let isChecked = $this.prop('checked');\r\n\r\n            if (isChecked) {\r\n                $this.closest('.recordlist-row-gaia').addClass('selected-row');\r\n            } else {\r\n                $this.closest('.recordlist-row-gaia').removeClass('selected-row');\r\n            }\r\n\r\n        });\r\n\r\n        if (!record['free_register_time'].value\r\n            || (new Date(record['free_register_time'].value).getTime() - TARGET_DATE.getTime()) < 0) {\r\n            $check.addClass('disabled');\r\n        }\r\n\r\n        $(row).find(`.value-${CHECKBOX_FIELD_ID}`)\r\n            .removeClass('recordlist-decimal-gaia')\r\n            .find('>div').empty().append($check);\r\n\r\n    });\r\n\r\n    return event;\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/cs_request.js","module.exports = \"<span class=\\\"input-checkbox-item-cybozu\\\">\\r\\n    <input type=\\\"checkbox\\\" name=\\\"checkbox\\\" class=\\\"input-checkbox-cybozu\\\">\\r\\n    <label></label>\\r\\n</span>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/html/checkbox.html\n// module id = 15\n// module chunks = 0"],"sourceRoot":""}